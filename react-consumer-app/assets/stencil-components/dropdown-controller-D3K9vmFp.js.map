{"version":3,"file":"dropdown-controller-D3K9vmFp.js","sources":["node_modules/@siemens/ix/dist/collection/components/dropdown/dropdown-controller.js"],"sourcesContent":["/*\n * SPDX-FileCopyrightText: 2024 Siemens AG\n *\n * SPDX-License-Identifier: MIT\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\nexport function hasDropdownItemWrapperImplemented(item) {\n    return (item !== null &&\n        item.getDropdownItemElement !== undefined &&\n        typeof item.getDropdownItemElement === 'function');\n}\nclass DropdownController {\n    constructor() {\n        this.dropdowns = new Map();\n        this.submenuIds = {};\n        this.isWindowListenerActive = false;\n    }\n    connected(dropdown) {\n        if (!this.isWindowListenerActive) {\n            this.addOverlayListeners();\n        }\n        this.dropdowns.set(dropdown.getId(), dropdown);\n        if (dropdown.discoverAllSubmenus) {\n            this.discoverSubmenus();\n        }\n    }\n    disconnected(dropdown) {\n        const id = dropdown.getId();\n        this.removeFromSubmenuIds(id);\n        this.dropdowns.delete(id);\n    }\n    removeFromSubmenuIds(id) {\n        this.dropdowns.forEach((dropdown) => {\n            const submenuIds = this.submenuIds[dropdown.getId()];\n            if (submenuIds) {\n                const index = submenuIds.indexOf(id);\n                if (index > -1) {\n                    submenuIds.splice(index, 1);\n                }\n            }\n        });\n        delete this.submenuIds[id];\n    }\n    getDropdownById(id) {\n        return this.dropdowns.get(id);\n    }\n    discoverSubmenus() {\n        this.dropdowns.forEach((dropdown) => {\n            dropdown.discoverSubmenu();\n        });\n    }\n    present(dropdown) {\n        var _a;\n        if (!dropdown.isPresent() && ((_a = dropdown.willPresent) === null || _a === void 0 ? void 0 : _a.call(dropdown))) {\n            this.submenuIds[dropdown.getId()] = dropdown.getAssignedSubmenuIds();\n            dropdown.present();\n        }\n    }\n    dismissChildren(uid) {\n        const childIds = this.submenuIds[uid] || [];\n        for (const id of childIds) {\n            const dropdown = this.dropdowns.get(id);\n            if (dropdown) {\n                this.dismiss(dropdown);\n            }\n        }\n    }\n    dismiss(dropdown) {\n        var _a;\n        if (dropdown.isPresent() && ((_a = dropdown.willDismiss) === null || _a === void 0 ? void 0 : _a.call(dropdown))) {\n            this.dismissChildren(dropdown.getId());\n            dropdown.dismiss();\n            delete this.submenuIds[dropdown.getId()];\n        }\n    }\n    dismissAll(ignoreBehaviorForIds = [], ignoreRelatedDropdowns = false) {\n        this.dropdowns.forEach((dropdown) => {\n            const preventClosing = dropdown.closeBehavior === 'inside' || dropdown.closeBehavior === false;\n            const shouldIgnore = ignoreBehaviorForIds.includes(dropdown.getId());\n            const path = this.buildComposedPath(dropdown.getId(), new Set());\n            if (ignoreBehaviorForIds.length > 0 && ignoreRelatedDropdowns) {\n                let skipRelatedDropdown = false;\n                ignoreBehaviorForIds.forEach((id) => {\n                    if (path.has(id)) {\n                        skipRelatedDropdown = true;\n                        return;\n                    }\n                });\n                if (!skipRelatedDropdown) {\n                    return;\n                }\n            }\n            if (!shouldIgnore && preventClosing) {\n                return;\n            }\n            this.dismiss(dropdown);\n        });\n    }\n    dismissOthers(uid) {\n        let path = this.buildComposedPath(uid, new Set());\n        path.add(uid);\n        this.dropdowns.forEach((dropdown) => {\n            if (dropdown.closeBehavior !== 'inside' &&\n                dropdown.closeBehavior !== false &&\n                !path.has(dropdown.getId())) {\n                this.dismiss(dropdown);\n            }\n        });\n    }\n    pathIncludesTrigger(eventTargets) {\n        for (let eventTarget of eventTargets) {\n            if (eventTarget instanceof HTMLElement) {\n                if (eventTarget.hasAttribute('data-ix-dropdown-trigger')) {\n                    return eventTarget;\n                }\n            }\n        }\n        return;\n    }\n    pathIncludesDropdown(eventTargets) {\n        return !!eventTargets.find((element) => element.tagName === 'IX-DROPDOWN');\n    }\n    buildComposedPath(id, path) {\n        if (this.submenuIds[id]) {\n            path.add(id);\n        }\n        for (const ruleKey of Object.keys(this.submenuIds)) {\n            if (this.submenuIds[ruleKey].includes(id)) {\n                this.buildComposedPath(ruleKey, path).forEach((key) => path.add(key));\n            }\n        }\n        return path;\n    }\n    addOverlayListeners() {\n        this.isWindowListenerActive = true;\n        window.addEventListener('click', (event) => {\n            const hasTrigger = this.pathIncludesTrigger(event.composedPath());\n            const hasDropdown = this.pathIncludesDropdown(event.composedPath());\n            if (!hasTrigger && !hasDropdown) {\n                this.dismissAll();\n            }\n        });\n        window.addEventListener('keydown', (event) => {\n            if (event.key === 'Escape') {\n                this.dismissAll([...this.dropdowns.keys()]);\n            }\n        });\n    }\n}\nexport const dropdownController = new DropdownController();\n//# sourceMappingURL=dropdown-controller.js.map\n"],"names":[],"mappings":"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","x_google_ignoreList":[0]}